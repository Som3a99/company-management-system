@model EmployeeProfileViewModel

@{
    ViewData["Title"] = $"{Model.FullName} - Profile";
    var imageUrl = !string.IsNullOrEmpty(Model.ImageUrl) ? Model.ImageUrl : "/uploads/images/avatar-user.png";
}

<style>
    .profile-header {
        background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-medium) 100%);
        color: white;
        padding: 2rem;
        border-radius: var(--radius-lg);
        margin-bottom: 2rem;
    }

    .profile-avatar {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        border: 4px solid white;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        object-fit: cover;
    }

    .profile-info-card {
        background: white;
        border-radius: var(--radius-lg);
        padding: 1.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 1.5rem;
    }

    .info-row {
        display: flex;
        justify-content: space-between;
        padding: 0.75rem 0;
        border-bottom: 1px solid var(--gray-200);
    }

        .info-row:last-child {
            border-bottom: none;
        }

    .info-label {
        font-weight: 600;
        color: var(--gray-700);
    }

    .info-value {
        color: var(--gray-900);
    }

    .section-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--gray-900);
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid var(--primary-main);
    }

    .related-card {
        background: var(--gray-50);
        border-radius: var(--radius-md);
        padding: 1.25rem;
        margin-bottom: 1rem;
        border-left: 4px solid var(--primary-main);
        transition: all 0.2s ease;
    }

        .related-card:hover {
            background: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateX(4px);
        }

        .related-card h6 {
            margin-bottom: 0.5rem;
            color: var(--gray-900);
        }

        .related-card .text-muted {
            font-size: 0.875rem;
        }

    .clickable-link {
        color: var(--primary-main);
        text-decoration: none;
        font-weight: 500;
        transition: color 0.2s ease;
    }

        .clickable-link:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }

    .status-badge-large {
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        font-weight: 600;
        font-size: 0.875rem;
    }
</style>

<div class="container-fluid px-4">
    <!-- Back Button -->
    <div class="mb-3 animate-in">
        <a asp-action="Index" class="btn btn-secondary btn-sm">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            Back to Employees
        </a>
    </div>

    <!-- Profile Header -->
    <div class="profile-header animate-in">
        <div class="row align-items-center">
            <div class="col-auto">
                <img src="@imageUrl"
                     alt="@Model.FullName"
                     class="profile-avatar"
                     onerror="this.src='/uploads/images/avatar-user.png'" />
            </div>
            <div class="col">
                <h1 class="mb-2">@Model.FullName</h1>
                <p class="mb-2 opacity-75">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-bottom: -3px;">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    @Model.Position
                </p>
                <p class="mb-0 opacity-75">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-bottom: -3px;">
                        <rect x="3" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                        <rect x="3" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                        <rect x="14" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                        <rect x="14" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                    </svg>
                    @if (!string.IsNullOrEmpty(Model.DepartmentName))
                    {
                        <a asp-controller="Department" asp-action="Profile" asp-route-id="@Model.DepartmentId"
                           class="text-white text-decoration-underline">
                            @Model.DepartmentName
                        </a>
                    }
                    else
                    {
                        <span>No Department Assigned</span>
                    }
                </p>
            </div>
            <div class="col-auto">
                @if (Model.IsActive)
                {
                    <span class="badge status-badge-large" style="background-color: #dcfce7; color: #166534;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-bottom: -2px;">
                            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                            <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        Active
                    </span>
                }
                else
                {
                    <span class="badge status-badge-large" style="background-color: #f3f4f6; color: #4b5563;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-bottom: -2px;">
                            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                            <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        Inactive
                    </span>
                }
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Left Column: Basic Information -->
        <div class="col-lg-6 animate-in">
            <div class="profile-info-card">
                <h5 class="section-title">Contact Information</h5>

                <div class="info-row">
                    <span class="info-label">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-bottom: -2px;">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            <polyline points="22,6 12,13 2,6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        Email
                    </span>
                    <span class="info-value">
                        <a href="mailto:@Model.Email" class="clickable-link">@Model.Email</a>
                    </span>
                </div>

                <div class="info-row">
                    <span class="info-label">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-bottom: -2px;">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        Phone
                    </span>
                    <span class="info-value">@Model.PhoneNumber</span>
                </div>
            </div>

            <div class="profile-info-card">
                <h5 class="section-title">Employment Details</h5>

                <div class="info-row">
                    <span class="info-label">Gender</span>
                    <span class="info-value">@Model.Gender</span>
                </div>

                <div class="info-row">
                    <span class="info-label">Hire Date</span>
                    <span class="info-value">@Model.HireDate.ToString("MMMM dd, yyyy")</span>
                </div>

                <div class="info-row">
                    <span class="info-label">Salary</span>
                    <span class="info-value fw-bold" style="color: var(--accent-main);">@Model.Salary.ToString("C")</span>
                </div>

                <div class="info-row">
                    <span class="info-label">Employee Since</span>
                    <span class="info-value">@Model.CreatedAt.ToString("MMMM dd, yyyy")</span>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="d-flex gap-2">
                <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary flex-fill">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Edit Profile
                </a>
                <a asp-action="Delete" asp-route-id="@Model.Id" class="btn btn-danger">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <polyline points="3 6 5 6 21 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Delete
                </a>
            </div>
        </div>

        <!-- Right Column: Related Information -->
        <div class="col-lg-6 animate-in">
            <!-- Department Card -->
            <div class="profile-info-card">
                <h5 class="section-title">Department</h5>
                @if (!string.IsNullOrEmpty(Model.DepartmentName))
                {
                    <div class="related-card">
                        <h6>
                            <a asp-controller="Department" asp-action="Profile" asp-route-id="@Model.DepartmentId"
                               class="clickable-link">
                                @Model.DepartmentName
                            </a>
                        </h6>
                        <p class="text-muted mb-0">
                            <span class="table-code">@Model.DepartmentCode</span>
                        </p>
                    </div>
                }
                else
                {
                    <p class="text-muted">Not assigned to any department</p>
                }
            </div>

            <!-- Managed Department Card -->
            @if (Model.ManagedDepartmentId.HasValue)
            {
                <div class="profile-info-card">
                    <h5 class="section-title">Managing Department</h5>
                    <div class="related-card">
                        <h6>
                            <a asp-controller="Department" asp-action="Profile" asp-route-id="@Model.ManagedDepartmentId"
                               class="clickable-link">
                                @Model.ManagedDepartmentName
                            </a>
                        </h6>
                        <p class="text-muted mb-1">
                            <span class="table-code">@Model.ManagedDepartmentCode</span>
                        </p>
                        <p class="text-muted mb-0">
                            <strong>@Model.ManagedDepartmentEmployeeCount</strong> employees
                        </p>
                    </div>
                </div>
            }

            <!-- Managed Project Card -->
            @if (Model.ManagedProjectId.HasValue)
            {
                <div class="profile-info-card">
                    <h5 class="section-title">Managing Project</h5>
                    <div class="related-card">
                        <h6>
                            <a asp-controller="Project" asp-action="Profile" asp-route-id="@Model.ManagedProjectId"
                               class="clickable-link">
                                @Model.ManagedProjectName
                            </a>
                        </h6>
                        <p class="text-muted mb-1">
                            <span class="table-code">@Model.ManagedProjectCode</span>
                        </p>
                        @if (!string.IsNullOrEmpty(Model.ManagedProjectDepartmentName))
                        {
                            <p class="text-muted mb-0">
                                Department:
                                <a asp-controller="Department" asp-action="Profile" asp-route-id="@Model.ManagedProjectDepartmentId"
                                   class="clickable-link">
                                    @Model.ManagedProjectDepartmentName
                                </a>
                            </p>
                        }
                    </div>
                </div>
            }

            <!-- Assigned Project Card -->
            @if (Model.AssignedProjectId.HasValue)
            {
                <div class="profile-info-card">
                    <h5 class="section-title">Assigned Project</h5>
                    <div class="related-card">
                        <h6>
                            <a asp-controller="Project" asp-action="Profile" asp-route-id="@Model.AssignedProjectId"
                               class="clickable-link">
                                @Model.AssignedProjectName
                            </a>
                        </h6>
                        <p class="text-muted mb-1">
                            <span class="table-code">@Model.AssignedProjectCode</span>
                        </p>
                        @if (!string.IsNullOrEmpty(Model.AssignedProjectManagerName))
                        {
                            <p class="text-muted mb-1">
                                Manager:
                                @if (Model.AssignedProjectManagerId.HasValue)
                                {
                                    <a asp-controller="Employee" asp-action="Profile" asp-route-id="@Model.AssignedProjectManagerId"
                                       class="clickable-link">
                                        @Model.AssignedProjectManagerName
                                    </a>
                                }
                                else
                                {
                                    <span>@Model.AssignedProjectManagerName</span>
                                }
                            </p>
                        }
                        @if (!string.IsNullOrEmpty(Model.AssignedProjectDepartmentName))
                        {
                            <p class="text-muted mb-0">
                                Department:
                                <a asp-controller="Department" asp-action="Profile" asp-route-id="@Model.AssignedProjectDepartmentId"
                                   class="clickable-link">
                                    @Model.AssignedProjectDepartmentName
                                </a>
                            </p>
                        }
                    </div>
                </div>
            }

            <!-- No Projects Message -->
            @if (!Model.ManagedProjectId.HasValue && !Model.AssignedProjectId.HasValue)
            {
                <div class="profile-info-card">
                    <h5 class="section-title">Projects</h5>
                    <p class="text-muted">Not assigned to any projects</p>
                </div>
            }
        </div>
    </div>
</div>