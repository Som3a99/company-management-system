@using ERP.PL.ViewModels.Pagination
@model PaginationInfoViewModel

@{
    var searchTerm = ViewData["SearchTerm"] as string;
    var status = ViewData["Status"] as string ?? ViewData["ManagerStatus"] as string ?? "all";
    var pageSize = Model.PageSize;
    var action = ViewContext.RouteData.Values["action"] as string;
    var controller = ViewContext.RouteData.Values["controller"] as string;
    var itemName = ViewData["ItemName"] as string ?? "items";
    var departmentId = ViewData["DepartmentId"] as int?;
}

@if (Model.TotalPages > 1)
{
    <div class="pagination animate-in">
        @if (Model.HasPreviousPage)
        {
            <a asp-controller="@controller" asp-action="@action"
               asp-route-id="@departmentId"
               asp-route-pageNumber="@(Model.PageNumber - 1)"
               asp-route-pageSize="@pageSize"
               asp-route-searchTerm="@searchTerm"
               asp-route-status="@status"
               asp-route-managerStatus="@status">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                Previous
            </a>
        }
        else
        {
            <span class="disabled">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                Previous
            </span>
        }

        @{
            var startPage = Math.Max(1, Model.PageNumber - 2);
            var endPage = Math.Min(Model.TotalPages, Model.PageNumber + 2);

            if (startPage > 1)
            {
                <a asp-controller="@controller" asp-action="@action"
                   asp-route-id="@departmentId"
                   asp-route-pageNumber="1"
                   asp-route-pageSize="@pageSize"
                   asp-route-searchTerm="@searchTerm"
                   asp-route-status="@status"
                   asp-route-managerStatus="@status">1</a>
                if (startPage > 2)
                {
                    <span>...</span>
                }
            }

            for (var i = startPage; i <= endPage; i++)
            {
                if (i == Model.PageNumber)
                {
                    <!-- ACTIVE PAGE - High contrast, cannot be missed -->
                    <span class="active" style="
                                        background-color: var(--accent-main);
                                        color: white;
                                        border-color: var(--accent-main);
                                        font-weight: 600;
                                        box-shadow: 0 2px 4px rgba(var(--accent-main-rgb), 0.3);
                                        position: relative;
                                        z-index: 10;">
                        @i
                    </span>
                }
                else
                {
                    <a asp-controller="@controller" asp-action="@action"
                       asp-route-id="@departmentId"
                       asp-route-pageNumber="@i"
                       asp-route-pageSize="@pageSize"
                       asp-route-searchTerm="@searchTerm"
                       asp-route-status="@status"
                       asp-route-managerStatus="@status">@i</a>
                }
            }

            if (endPage < Model.TotalPages)
            {
                if (endPage < Model.TotalPages - 1)
                {
                    <span>...</span>
                }
                <a asp-controller="@controller" asp-action="@action"
                   asp-route-id="@departmentId"
                   asp-route-pageNumber="@Model.TotalPages"
                   asp-route-pageSize="@pageSize"
                   asp-route-searchTerm="@searchTerm"
                   asp-route-status="@status"
                   asp-route-managerStatus="@status">@Model.TotalPages</a>
            }
        }

        @if (Model.HasNextPage)
        {
            <a asp-controller="@controller" asp-action="@action"
               asp-route-id="@departmentId"
               asp-route-pageNumber="@(Model.PageNumber + 1)"
               asp-route-pageSize="@pageSize"
               asp-route-searchTerm="@searchTerm"
               asp-route-status="@status"
               asp-route-managerStatus="@status">
                Next
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
            </a>
        }
        else
        {
            <span class="disabled">
                Next
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
            </span>
        }
    </div>

    <div class="text-center mt-3 text-muted small">
        Showing @Model.StartIndex - @Model.EndIndex of @Model.TotalCount @itemName
    </div>
}